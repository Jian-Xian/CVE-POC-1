# CVE-2019-15910 - Insecue key transport 

## Description
   The security of ZigBee transmission data is mostly based on network key for data encryption, and the network key of the devices we tested that use the default trust center link key to encrypt the transmission of the network key. The default trust center link key is disclosed for years ago. We can gain sensitive information, tamper with messages, take over the smart home devices, denial of service attack when got the network key.
## ASUS smart home devices attack demonstration
### 1. System architecture
   The system architecture of this research attack demonstration, as shown in Figure 1, is divided into attacker and victim.

<div align=center>
<center>
<img src="https://github.com/chengcheng227/CVE-POC-TEST/blob/master/picture/arch.jpg" width="50%" height="50%" />
 
Figure 1. Architecture of the attack demonstration
</center></div>
Attacker：

  1.	Laptop（Ubuntu 16.04.3 LTS）
  2.	Atmel RZ Raven USB sticks（2.4 GHz dongle）
  3.	KillerBee （Research mainly modifies the KillerBee API）
  4.	Zigdiggity  
  5.	Wireshark

Victim：	

  The environment of the victims is that the gateway acts as a ZigBee coordinator and is responsible for accessing the Internet,   establishing a ZigBee network, and connecting to the end devices and router. The users obtain the messages of the end devices or router  by using smart devices（e.g. smart phone…）. The victim devices of this attack demonstration use ASUS smart home devices. 
Their model:
  1.	Gateway acts as ZigBee coordinator：HG100 
  2.	Router：MW100
  3.	End device：WS-101
  4.	End device：TS-101
  5.	End device：AS-101
  6.	End device：MS-101
  7.	End device：DL-101

## 2. Key sniffing
---
### 2.1 Passive key sniffing
  After the attackers sniff the messages paired with the end devices or router, they can use the default trust center link key to decrypt key transport message to obtain the network key, as shown in Figure 2.

<div align=center>
<center>
<img src="https://github.com/chengcheng227/CVE-POC-TEST/blob/master/picture/arch.jpg" width="50%" height="50%" /> 
Figure 2. Passive key sniffing
</center></div>

### 2.2 Active key sniffing
The attackers send the fake rejoin requests of the end device or router. After the end device or router sends messages during the attack, it will be to rejoin the network. After the attackers sniff the rejoin network messages with the end device or router, they can use the default trust center link key to decrypt key transport message to obtain the network key, as shown in Figure 3.

<div align=center>
<center>
<img src="https://github.com/chengcheng227/CVE-POC-TEST/blob/master/picture/arch.jpg" width="50%" height="50%" /> 
Figure 3. Active key sniffing
</center></div>

# >>>>>>>>>>>>>>>>>>>>>>>>>> 111111111111111111111111111111111111


![image](https://github.com/chengcheng227/CVE-POC-TEST/blob/master/picture/arch.jpg =50%x)
