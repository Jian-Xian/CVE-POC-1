# CVE-2019-15912_2
## Insecure trust center rejoin procedure - Network address Conflict
## Description
   An issue was discovered on ASUS HG100, WS-101, MW100 devices using ZigBee PRO.   
   Attackers can use the ZigBee trust center rejoin procedure to perform mutiple denial of service attacks.  
   Although we only tested WS101 for end devices,  but we think that all end devices will be affected.
   
## ASUS smart home devices attack demonstration
### 1. System architecture
   The system architecture of this research attack demonstration, as shown in Figure 1, is divided into attacker and victim.

<div align=center>
<center>
<img src="https://github.com/chengcheng227/CVE-POC-TEST/blob/master/picture/159122-1.png" width="80%" height="80%" /> 
 
Figure 1. Architecture of the attack demonstration
</center></div>

Attacker：
  1. Laptop（Ubuntu 16.04.3 LTS）  
  2. Atmel RZ Raven USB sticks（2.4 GHz dongle）
  3. KillerBee （Research mainly modifies the KillerBee API）
  4. Zigdiggity  
  5. Wireshark

Victim：
	The environment of the victims is that the gateway acts as a ZigBee coordinator and is responsible for accessing the Internet, establishing a ZigBee network, and connecting to the router. And the router is connected with end devices. The users obtain the messages of the end devices and router by using smart devices（e.g.：smart phone…）. The victim devices of this attack demonstration use ASUS smart home devices. Their model:

   1. Gateway acts as ZigBee coordinator：HG100
   2. Router：MW100
   3. End device：WS-101

    
## 2. Denial of Service Attack - Insecure trust center rejoin procedure_Network Address Conflict

The attackers send the fake rejoin requests containing the same network address of the MW100, but the different media access control address. 
    If the attackers continue to send fake packets, the MW100 will detect the network address conflict.  And connected MW100's smart home devices don't know the network address is changed, they will send the packets to the old network address, as shown in Figure 2 and Figure 3. 

 <div align=center>
<center>
<img src="https://github.com/chengcheng227/CVE-POC-TEST/blob/master/picture/159122-2.png" width="100%" height="100%" /> 
 
Figure 2. Insecure Trust Center rejoin

</center></div>
<div align=center>
  
<center>
<img src="https://github.com/chengcheng227/CVE-POC-TEST/blob/master/picture/159122-3.png" width="100%" height="100%" /> 
 
Figure 3. Insecure Trust Center rejoin 2
</center></div>
